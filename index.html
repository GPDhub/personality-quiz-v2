<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€§æ ¼è¨ºæ–­ã‚¯ã‚¤ã‚º</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .progress-info {
            font-size: 18px;
            font-weight: bold;
            color: #007bff;
        }
        .phase-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
            color: #495057;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #007bff;
            transition: width 0.3s;
        }
        .meta {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 20px;
        }
        .question {
            margin-bottom: 30px;
        }
        .question h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 20px;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        .option {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-size: 14px;
        }
        .option:hover {
            border-color: #007bff;
            background-color: #f8f9fa;
        }
        .option.active {
            border-color: #007bff;
            background-color: #e7f3ff;
            font-weight: bold;
        }
        .attention-note {
            font-size: 12px;
            color: #6c757d;
            margin-top: 10px;
            display: none;
        }
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 30px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-secondary:hover:not(:disabled) {
            background-color: #545b62;
        }
        .btn:disabled {
            background-color: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }
        .results {
            text-align: center;
        }
        .results h2 {
            color: #007bff;
            margin-bottom: 20px;
        }
        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .score-item {
            text-align: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .score-label {
            font-size: 14px;
            margin-bottom: 10px;
        }
        .score-value {
            font-size: 28px;
            font-weight: bold;
            color: #007bff;
        }
        .score-bar {
            width: 100%;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-top: 10px;
        }
        .score-bar-fill {
            height: 100%;
            background-color: #007bff;
            border-radius: 4px;
        }
        .score-level {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .type-result {
            margin-top: 25px;
            padding: 20px;
            background-color: #e7f3ff;
            border-radius: 8px;
            border: 2px solid #007bff;
        }
        .type-title {
            margin-top: 0;
            color: #007bff;
            display: flex;
            align-items: center;
        }
        .analysis-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .analysis-option {
            padding: 15px;
            border: 2px solid #007bff;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            min-width: 120px;
            transition: all 0.2s;
        }
        .analysis-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .explanation-section {
            margin-top: 30px;
        }
        .trait-explanation {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .trait-title {
            margin: 0 0 15px 0;
            color: #333;
            display: flex;
            align-items: center;
        }
        .trait-bar {
            display: inline-block;
            width: 40px;
            height: 20px;
            background-color: #007bff;
            margin-right: 10px;
            border-radius: 3px;
        }
        .advice-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #e7f3ff;
            border-radius: 8px;
            border: 2px solid #007bff;
        }
        .advice-title {
            margin-top: 0;
            color: #007bff;
        }
        .disclaimer {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            font-size: 12px;
            color: #888;
        }
        .hidden {
            display: none;
        }
        @media (max-width: 600px) {
            .analysis-options {
                flex-direction: column;
                align-items: center;
            }
            .analysis-option {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æ€§æ ¼è¨ºæ–­ v2</h1>
            <div class="progress-info" id="progressInfo">1/5</div>
        </div>
        
        <div class="phase-title" id="phaseTitle">åŸºæœ¬è¨ºæ–­ï¼ˆ5å•ï¼‰</div>

        <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤º -->
        <div id="progressSection">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="meta" id="metaInfo">é€²æ— 0%</div>
        </div>

        <!-- è³ªå•è¡¨ç¤º -->
        <div id="questionSection" class="question">
            <h3 id="questionText"></h3>
            <div class="options" id="answerOptions"></div>
            <div class="attention-note" id="attentionNote">
                æ³¨æ„ãƒã‚§ãƒƒã‚¯å•é¡Œ: æŒ‡ç¤ºé€šã‚Šã«å›ç­”ã—ã¦ãã ã•ã„
            </div>
        </div>

        <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ -->
        <div id="controlSection" class="controls">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">æˆ»ã‚‹</button>
            <button class="btn btn-secondary" id="nextBtn" onclick="nextQuestion()">æ¬¡ã¸</button>
            <button class="btn btn-primary" id="resultBtn" onclick="showResult()">åŸºæœ¬çµæœã‚’è¦‹ã‚‹</button>
            <button class="btn btn-secondary" onclick="resetQuiz()">åˆæœŸåŒ–</button>
        </div>

        <!-- åŸºæœ¬çµæœè¡¨ç¤º -->
        <div id="basicResult" class="results hidden">
            <h2>åŸºæœ¬è¨ºæ–­çµæœ</h2>
            <div class="score-grid" id="basicScores"></div>
            <div id="personalityType"></div>
            <div id="traitFeatures"></div>
            
            <h3 style="margin-top:30px">ã•ã‚‰ã«è©³ã—ãåˆ†æã—ã¾ã™ã‹ï¼Ÿ</h3>
            <p style="font-size:14px; color:#666; text-align:center; margin:10px 0 20px 0">
                ã‚ˆã‚Šå…·ä½“çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã¨è©³ç´°ãªè§£èª¬ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™
            </p>
            <div class="analysis-options">
                <div class="analysis-option" onclick="startDetailedAnalysis('personality')">
                    <div style="font-weight:bold; margin-bottom:5px">æ€§æ ¼åˆ¤æ–­</div>
                    <div style="font-size:12px; color:#666">æ€§æ ¼ç‰¹æ€§ã®è©³ç´°åˆ†æ</div>
                </div>
                <div class="analysis-option" onclick="startDetailedAnalysis('career')">
                    <div style="font-weight:bold; margin-bottom:5px">é©è·åˆ¤æ–­</div>
                    <div style="font-size:12px; color:#666">è·æ¥­é©æ€§ã®åˆ†æ</div>
                </div>
                <div class="analysis-option" onclick="startDetailedAnalysis('love')">
                    <div style="font-weight:bold; margin-bottom:5px">æ‹æ„›åˆ¤æ–­</div>
                    <div style="font-size:12px; color:#666">æ‹æ„›å‚¾å‘ã®åˆ†æ</div>
                </div>
            </div>
        </div>

        <!-- è©³ç´°çµæœè¡¨ç¤º -->
        <div id="detailedResult" class="results hidden">
            <h2 id="resultTitle">è©³ç´°åˆ†æçµæœ</h2>
            <div class="score-grid" id="detailedScores"></div>
            <div id="detailedExplanations" class="explanation-section"></div>
            <div id="comprehensiveAdvice"></div>
            <div class="disclaimer">
                ã“ã®çµæœã¯çµ±è¨ˆçš„ãªå‚¾å‘ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚å€‹äººå·®ãŒã‚ã‚‹ã“ã¨ã‚’ã”ç†è§£ãã ã•ã„ã€‚
            </div>
            <button class="btn btn-primary" onclick="resetQuiz()" style="margin-top:20px">
                æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™
            </button>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentPhase = 'basic';
        let currentQuestions = [];
        let currentAnswers = {};
        let currentIndex = 0;
        let basicResult = null;
        let selectedAnalysis = null;

        // è³ªå•ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const QUESTIONS = {
            basic: [
                {id: 'O1', text: 'æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹ã®ãŒå¥½ãã ', trait: 'O'},
                {id: 'C1', text: 'è¨ˆç”»ã‚’ç«‹ã¦ã¦ç‰©äº‹ã‚’é€²ã‚ã‚‹ã®ãŒå¾—æ„ã ', trait: 'C'},
                {id: 'E1', text: 'äººã¨è©±ã™ã“ã¨ã§æ´»åŠ›ãŒæ¹§ã„ã¦ãã‚‹', trait: 'E'},
                {id: 'A1', text: 'äººã®æ°—æŒã¡ã‚’ç†è§£ã—ã‚ˆã†ã¨åŠªã‚ã‚‹', trait: 'A'},
                {id: 'N1', text: 'å¿ƒé…äº‹ãŒã‚ã‚‹ã¨æ°—ã«ãªã£ã¦ä»•æ–¹ãŒãªã„', trait: 'N'}
            ],
            personality: [
                // é–‹æ”¾æ€§
                {id: 'OP1', text: 'æŠ½è±¡çš„ãªæ¦‚å¿µã«ã¤ã„ã¦è€ƒãˆã‚‹ã®ãŒå¥½ãã ', trait: 'O'},
                {id: 'OP2', text: 'èŠ¸è¡“ä½œå“ã‚’è¦‹ã¦æ·±ãæ„Ÿå‹•ã™ã‚‹ã“ã¨ãŒã‚ã‚‹', trait: 'O'},
                {id: 'OP3', text: 'å“²å­¦çš„ãªè­°è«–ã«èˆˆå‘³ãŒã‚ã‚‹', trait: 'O'},
                // èª å®Ÿæ€§
                {id: 'CP1', text: 'æ±ºã‚ãŸç›®æ¨™ã«å‘ã‹ã£ã¦ç¶™ç¶šçš„ã«åŠªåŠ›ã§ãã‚‹', trait: 'C'},
                {id: 'CP2', text: 'ç´°ã‹ã„ä½œæ¥­ã§ã‚‚ãƒŸã‚¹ãªãå®Œæˆã•ã›ã‚‹', trait: 'C'},
                {id: 'CP3', text: 'è¨ˆç”»é€šã‚Šã«ç‰©äº‹ãŒé€²ã¾ãªã„ã¨ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã‚‹', trait: 'C'},
                // å¤–å‘æ€§
                {id: 'EP1', text: 'çŸ¥ã‚‰ãªã„äººã®é›†ã¾ã‚Šã§ã‚‚ç©æ¥µçš„ã«å‚åŠ ã§ãã‚‹', trait: 'E'},
                {id: 'EP2', text: 'äººå‰ã§ç™ºè¡¨ã™ã‚‹ã“ã¨ã«æŠµæŠ—ãŒãªã„', trait: 'E'},
                {id: 'EP3', text: 'é™ã‹ãªç’°å¢ƒã§ä¸€äººã§éã”ã™ã®ãŒå¥½ãã ', trait: 'E', reverse: true},
                // å”èª¿æ€§
                {id: 'AP1', text: 'ä»–äººã®ç«‹å ´ã«ç«‹ã£ã¦ç‰©äº‹ã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹', trait: 'A'},
                {id: 'AP2', text: 'äººã¨ã®äº‰ã„ã¯æ¥µåŠ›é¿ã‘ãŸã„ã¨æ€ã†', trait: 'A'},
                {id: 'AP3', text: 'è‡ªåˆ†ã®æ„è¦‹ã‚’é€šã™ãŸã‚ãªã‚‰å¤šå°‘å¼·å¼•ã§ã‚‚ã„ã„', trait: 'A', reverse: true},
                // ç¥çµŒç—‡å‚¾å‘
                {id: 'NP1', text: 'äºˆæœŸã—ãªã„å‡ºæ¥äº‹ã«å‹•æºã—ã‚„ã™ã„', trait: 'N'},
                {id: 'NP2', text: 'ä»–äººã®è©•ä¾¡ãŒæ°—ã«ãªã£ã¦ä»•æ–¹ãŒãªã„', trait: 'N'},
                {id: 'NP3', text: 'å›°é›£ãªçŠ¶æ³ã§ã‚‚å†·é™ã«å¯¾å‡¦ã§ãã‚‹', trait: 'N', reverse: true},
                // æ³¨æ„ãƒã‚§ãƒƒã‚¯
                {id: 'ATT1', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œã©ã¡ã‚‰ã§ã‚‚ãªã„ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'},
                {id: 'ATT2', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œå…¨ããã†æ€ã‚ãªã„ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'}
            ],
            career: [
                // é–‹æ”¾æ€§
                {id: 'OC1', text: 'æ–°ã—ã„ã‚¹ã‚­ãƒ«ã‚„çŸ¥è­˜ã®ç¿’å¾—ã«ç©æ¥µçš„ã ', trait: 'O'},
                {id: 'OC2', text: 'æ¥­å‹™æ”¹å–„ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è€ƒãˆã‚‹ã®ãŒå¥½ãã ', trait: 'O'},
                {id: 'OC3', text: 'æ—¢å­˜ã®ãƒ«ãƒ¼ãƒ«ã‚„æ‰‹é †ã‚’ç–‘å•ã«æ€ã†ã“ã¨ãŒã‚ã‚‹', trait: 'O'},
                // èª å®Ÿæ€§
                {id: 'CC1', text: 'ç· åˆ‡ã‚’å®ˆã‚‹ã“ã¨ã‚’æœ€é‡è¦è¦–ã—ã¦ã„ã‚‹', trait: 'C'},
                {id: 'CC2', text: 'å“è³ªã®é«˜ã„ä»•äº‹ã‚’ã™ã‚‹ãŸã‚ã«æ™‚é–“ã‚’ã‹ã‘ã‚‹', trait: 'C'},
                {id: 'CC3', text: 'è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã‚’ä¸¦è¡Œã—ã¦é€²ã‚ã‚‹ã®ãŒå¾—æ„ã ', trait: 'C'},
                // å¤–å‘æ€§
                {id: 'EC1', text: 'ä¼šè­°ã§ç©æ¥µçš„ã«ç™ºè¨€ã—è­°è«–ã‚’ãƒªãƒ¼ãƒ‰ã§ãã‚‹', trait: 'E'},
                {id: 'EC2', text: 'ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é«˜ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹', trait: 'E'},
                {id: 'EC3', text: 'å€‹äººä½œæ¥­ã®æ–¹ãŒæˆæœã‚’ä¸Šã’ã‚„ã™ã„', trait: 'E', reverse: true},
                // å”èª¿æ€§
                {id: 'AC1', text: 'åŒåƒšã¨ã®å”åŠ›ã‚’é‡è¦–ã—ã¦ä»•äº‹ã‚’é€²ã‚ã‚‹', trait: 'A'},
                {id: 'AC2', text: 'é¡§å®¢ã®è¦æœ›ã«ã¯å¯èƒ½ãªé™ã‚Šå¿œãˆãŸã„ã¨æ€ã†', trait: 'A'},
                {id: 'AC3', text: 'æˆæœã‚’ä¸Šã’ã‚‹ãŸã‚ãªã‚‰å¤šå°‘ã®ç«¶äº‰ã¯ä»•æ–¹ãŒãªã„', trait: 'A', reverse: true},
                // ç¥çµŒç—‡å‚¾å‘
                {id: 'NC1', text: 'ç· åˆ‡ãŒè¿«ã£ã¦ã‚‚ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã«è² ã‘ãšã«ä½œæ¥­ã§ãã‚‹', trait: 'N', reverse: true},
                {id: 'NC2', text: 'ã‚¯ãƒ¬ãƒ¼ãƒ å¯¾å¿œãªã©ã®å›°é›£ãªçŠ¶æ³ã§ã‚‚å†·é™ã§ã„ã‚‰ã‚Œã‚‹', trait: 'N', reverse: true},
                {id: 'NC3', text: 'ä»•äº‹ã®ãƒŸã‚¹ã‚’æŒ‡æ‘˜ã•ã‚Œã‚‹ã¨æ·±ãè½ã¡è¾¼ã‚€', trait: 'N'},
                // æ³¨æ„ãƒã‚§ãƒƒã‚¯
                {id: 'ATT3', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œã‚„ã‚„ãã†æ€ã†ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'},
                {id: 'ATT4', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œã‚ã¾ã‚Šãã†æ€ã‚ãªã„ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'}
            ],
            love: [
                // é–‹æ”¾æ€§
                {id: 'OL1', text: 'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã¯æ–°ã—ã„ä½“é¨“ã‚’å…±æœ‰ã—ãŸã„', trait: 'O'},
                {id: 'OL2', text: 'ç›¸æ‰‹ã®ä¾¡å€¤è¦³ãŒè‡ªåˆ†ã¨é•ã£ã¦ã‚‚å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹', trait: 'O'},
                {id: 'OL3', text: 'æ‹æ„›é–¢ä¿‚ã§ã¯å®‰å®šæ€§ã‚’æœ€ã‚‚é‡è¦–ã™ã‚‹', trait: 'O', reverse: true},
                // èª å®Ÿæ€§
                {id: 'CL1', text: 'æ‹æ„›ã«ãŠã„ã¦ã‚‚ç´„æŸã¯å¿…ãšå®ˆã‚‹ã¹ãã ã¨æ€ã†', trait: 'C'},
                {id: 'CL2', text: 'å°†æ¥ã‚’è¦‹æ®ãˆãŸçœŸå‰£ãªäº¤éš›ã‚’ã—ãŸã„', trait: 'C'},
                {id: 'CL3', text: 'æ‹æ„›ã§ã¯æ„Ÿæƒ…ã‚’å„ªå…ˆã—ã¦è¡Œå‹•ã™ã‚‹ã“ã¨ãŒå¤šã„', trait: 'C', reverse: true},
                // å¤–å‘æ€§
                {id: 'EL1', text: 'å¥½ãã«ãªã£ãŸã‚‰ç©æ¥µçš„ã«ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã™ã‚‹', trait: 'E'},
                {id: 'EL2', text: 'æ‹äººã¨ä¸€ç·’ã«å‹äººãŸã¡ã¨éã”ã™æ™‚é–“ã‚‚æ¥½ã—ã‚ã‚‹', trait: 'E'},
                {id: 'EL3', text: 'äºŒäººãã‚Šã§éã”ã™æ™‚é–“ãŒæœ€ã‚‚å¤§åˆ‡ã ', trait: 'E', reverse: true},
                // å”èª¿æ€§
                {id: 'AL1', text: 'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®æ°—æŒã¡ã‚’æœ€å„ªå…ˆã«è€ƒãˆã¦è¡Œå‹•ã™ã‚‹', trait: 'A'},
                {id: 'AL2', text: 'å–§å˜©ã«ãªã‚Šãã†ãªã¨ãã¯è‡ªåˆ†ãŒæŠ˜ã‚Œã‚‹ã“ã¨ãŒå¤šã„', trait: 'A'},
                {id: 'AL3', text: 'æ‹æ„›ã§ã¯è‡ªåˆ†ã®æ„è¦‹ã‚’ã¯ã£ãã‚Šä¼ãˆã‚‹ã“ã¨ãŒå¤§åˆ‡ã ', trait: 'A', reverse: true},
                // ç¥çµŒç—‡å‚¾å‘
                {id: 'NL1', text: 'æ‹äººã‹ã‚‰ã®é€£çµ¡ãŒé…ã„ã¨ä¸å®‰ã«ãªã£ã¦ã—ã¾ã†', trait: 'N'},
                {id: 'NL2', text: 'æ‹äººãŒä»–ã®äººã¨è¦ªã—ãã—ã¦ã„ã‚‹ã®ã‚’è¦‹ã‚‹ã¨å«‰å¦¬ã—ã¦ã—ã¾ã†', trait: 'N'},
                {id: 'NL3', text: 'æ‹æ„›ã®ã‚‚ã¤ã‚ŒãŒã‚ã£ã¦ã‚‚å†·é™ã«å¯¾å‡¦ã§ãã‚‹', trait: 'N', reverse: true},
                // æ³¨æ„ãƒã‚§ãƒƒã‚¯
                {id: 'ATT5', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œã¨ã¦ã‚‚ãã†æ€ã†ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'},
                {id: 'ATT6', text: 'æ³¨æ„ãƒã‚§ãƒƒã‚¯ï¼šã“ã®è¨­å•ã¯ã€Œã©ã¡ã‚‰ã§ã‚‚ãªã„ã€ã‚’é¸ã‚“ã§ãã ã•ã„', type: 'attention'}
            ]
        };

        const SCALE_LABELS = {
            1: 'å…¨ããã†æ€ã‚ãªã„',
            2: 'ã‚ã¾ã‚Šãã†æ€ã‚ãªã„', 
            3: 'ã©ã¡ã‚‰ã§ã‚‚ãªã„',
            4: 'ã‚„ã‚„ãã†æ€ã†',
            5: 'ã¨ã¦ã‚‚ãã†æ€ã†'
        };

        const TRAIT_NAMES = {
            O: 'é–‹æ”¾æ€§',
            C: 'èª å®Ÿæ€§', 
            E: 'å¤–å‘æ€§',
            A: 'å”èª¿æ€§',
            N: 'ç¥çµŒç—‡å‚¾å‘'
        };

        // ã‚¹ã‚³ã‚¢è¨ˆç®—
        function scoreOf(answer, reverse = false) {
            const value = reverse ? 6 - answer : answer;
            return (value - 1) / 4; // 1-5 ã‚’ 0-1 ã«æ­£è¦åŒ–
        }

        // ãƒ¬ãƒ™ãƒ«åˆ¤å®š
        function getLevel(score) {
            if (score >= 70) return 'é«˜';
            if (score >= 30) return 'ä¸­'; 
            return 'ä½';
        }

        // åˆæœŸåŒ–
        function init() {
            currentQuestions = QUESTIONS.basic;
            updateUI();
        }

        // è³ªå•ã«å›ç­”
        function answerQuestion(value) {
            const currentQuestion = currentQuestions[currentIndex];
            currentAnswers[currentQuestion.id] = value;
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.classList.toggle('active', parseInt(option.dataset.value) === value);
            });
            
            updateUI();
        }

        // å‰ã®è³ªå•
        function previousQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                updateUI();
            }
        }

        // æ¬¡ã®è³ªå•
        function nextQuestion() {
            if (currentIndex < currentQuestions.length - 1) {
                currentIndex++;
                updateUI();
            }
        }

        // ã™ã¹ã¦å›ç­”æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
        function allAnswered() {
            return currentQuestions.every(q => currentAnswers[q.id] !== undefined);
        }

        // çµæœè¡¨ç¤º
        function showResult() {
            if (!allAnswered()) {
                alert(currentPhase === 'basic' ? 'ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚' : 'æœªå›ç­”ãŒã‚ã‚Šã¾ã™ã€‚ã™ã¹ã¦å›ç­”ã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            if (currentPhase === 'basic') {
                showBasicResult();
            } else {
                showDetailedResult();
            }
        }

        // åŸºæœ¬çµæœè¡¨ç¤º
        function showBasicResult() {
            const traits = {O: 0, C: 0, E: 0, A: 0, N: 0};

            for (const trait of ['O', 'C', 'E', 'A', 'N']) {
                const question = currentQuestions.find(q => q.trait === trait);
                if (question && currentAnswers[question.id]) {
                    const value = currentAnswers[question.id];
                    const score01 = scoreOf(value, !!question.reverse);
                    traits[trait] = Math.round(score01 * 100);
                }
            }

            basicResult = traits;
            displayBasicResult(traits);
        }

        // åŸºæœ¬çµæœè¡¨ç¤ºUI
        function displayBasicResult(traits) {
            // ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('progressSection').classList.add('hidden');
            document.getElementById('questionSection').classList.add('hidden'); 
            document.getElementById('controlSection').classList.add('hidden');
            document.getElementById('basicResult').classList.remove('hidden');

            // ã‚¹ã‚³ã‚¢è¡¨ç¤º
            const scoresDiv = document.getElementById('basicScores');
            const traitKeys = ['O', 'C', 'E', 'A', 'N'];
            
            scoresDiv.innerHTML = traitKeys.map(trait => {
                const score = traits[trait];
                const level = getLevel(score);
                return `
                    <div class="score-item">
                        <div class="score-label">${TRAIT_NAMES[trait]}</div>
                        <div class="score-value">${score}%</div>
                        <div class="score-level">(${level}ãƒ¬ãƒ™ãƒ«)</div>
                    </div>
                `;
            }).join('');

            // æ€§æ ¼ã‚¿ã‚¤ãƒ—åˆ¤å®š
            const personalityType = getPersonalityType(traits);
            document.getElementById('personalityType').innerHTML = `
                <div class="type-result">
                    <h3 class="type-title">
                        <span style="margin-right:8px">ğŸ¯</span>
                        ã‚ãªãŸã®æ€§æ ¼ã‚¿ã‚¤ãƒ—: ${personalityType.type}
                    </h3>
                    <p style="margin:10px 0 0 0; line-height:1.6; color:#333">
                        ${personalityType.description}
                    </p>
                </div>
            `;
        }

        // è©³ç´°åˆ†æé–‹å§‹
        function startDetailedAnalysis(analysisType) {
            selectedAnalysis = analysisType;
            currentQuestions = QUESTIONS[analysisType];
            currentAnswers = {};
            currentIndex = 0;
            currentPhase = analysisType;

            // UIæ›´æ–°
            document.getElementById('basicResult').classList.add('hidden');
            document.getElementById('progressSection').classList.remove('hidden');
            document.getElementById('questionSection').classList.remove('hidden');
            document.getElementById('controlSection').classList.remove('hidden');

            // ãƒ•ã‚§ãƒ¼ã‚ºã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            const phaseText = analysisType === 'personality' ? 'æ€§æ ¼è©³ç´°åˆ†æï¼ˆ17å•ï¼‰' :
                              analysisType === 'career' ? 'é©è·åˆ†æï¼ˆ17å•ï¼‰' :
                              'æ‹æ„›å‚¾å‘åˆ†æï¼ˆ17å•ï¼‰';
            document.getElementById('phaseTitle').textContent = phaseText;

            // çµæœãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
            const resultBtnText = analysisType === 'personality' ? 'æ€§æ ¼åˆ†æçµæœã‚’è¦‹ã‚‹' :
                                  analysisType === 'career' ? 'é©è·åˆ†æçµæœã‚’è¦‹ã‚‹' :
                                  'æ‹æ„›åˆ†æçµæœã‚’è¦‹ã‚‹';
            document.getElementById('resultBtn').textContent = resultBtnText;

            updateUI();
        }

        // è©³ç´°çµæœè¡¨ç¤º
        function showDetailedResult() {
            const traits = {O: 0, C: 0, E: 0, A: 0, N: 0};

            // ã‚¹ã‚³ã‚¢è¨ˆç®—
            for (const trait of ['O', 'C', 'E', 'A', 'N']) {
                const questions = currentQuestions.filter(q => q.trait === trait);
                let sum = 0;
                let count = 0;

                for (const question of questions) {
                    if (currentAnswers[question.id]) {
                        const value = currentAnswers[question.id];
                        const score01 = scoreOf(value, !!question.reverse);
                        sum += score01;
                        count++;
                    }
                }

                if (count > 0) {
                    traits[trait] = Math.round((sum / count) * 100);
                }
            }

            displayDetailedResult(traits);
        }

        // è©³ç´°çµæœè¡¨ç¤ºUI
        function displayDetailedResult(traits) {
            // ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('progressSection').classList.add('hidden');
            document.getElementById('questionSection').classList.add('hidden');
            document.getElementById('controlSection').classList.add('hidden');
            document.getElementById('detailedResult').classList.remove('hidden');

            // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            const titleText = selectedAnalysis === 'personality' ? 'æ€§æ ¼åˆ†æçµæœ' :
                              selectedAnalysis === 'career' ? 'é©è·åˆ†æçµæœ' :
                              'æ‹æ„›åˆ†æçµæœ';
            document.getElementById('resultTitle').textContent = titleText;

            // ã‚¹ã‚³ã‚¢è¡¨ç¤º
            const scoresDiv = document.getElementById('detailedScores');
            scoresDiv.innerHTML = ['O', 'C', 'E', 'A', 'N'].map(trait => {
                const score = traits[trait];
                const level = getLevel(score);
                return `
                    <div class="score-item">
                        <div class="score-label">${TRAIT_NAMES[trait]}</div>
                        <div class="score-value">${score}%</div>
                        <div class="score-bar">
                            <div class="score-bar-fill" style="width:${score}%"></div>
                        </div>
                        <div class="score-level">(${level}ãƒ¬ãƒ™ãƒ«)</div>
                    </div>
                `;
            }).join('');

            // è©³ç´°è§£èª¬
            displayDetailedExplanations(traits);
        }

        // è©³ç´°è§£èª¬è¡¨ç¤º
        function displayDetailedExplanations(traits) {
            const explanationsDiv = document.getElementById('detailedExplanations');
            
            explanationsDiv.innerHTML = `
                <h3>è©³ç´°è§£èª¬</h3>
                ${['O', 'C', 'E', 'A', 'N'].map(trait => {
                    const score = traits[trait];
                    const level = getLevel(score);
                    const explanation = getTraitExplanation(trait, score);
                    
                    return `
                        <div class="trait-explanation">
                            <h4 class="trait-title">
                                <span class="trait-bar"></span>
                                ${TRAIT_NAMES[trait]} (${score}% - ${level}ãƒ¬ãƒ™ãƒ«)
                            </h4>
                            <p style="margin:0; line-height:1.6; color:#555">
                                ${explanation}
                            </p>
                        </div>
                    `;
                }).join('')}
            `;

            // ç·åˆã‚¢ãƒ‰ãƒã‚¤ã‚¹
            displayComprehensiveAdvice();
        }

        // ç·åˆã‚¢ãƒ‰ãƒã‚¤ã‚¹è¡¨ç¤º
        function displayComprehensiveAdvice() {
            const adviceDiv = document.getElementById('comprehensiveAdvice');
            const adviceTitle = selectedAnalysis === 'personality' ? 'æ€§æ ¼ç‰¹æ€§ã‚’æ´»ã‹ã™ãƒ’ãƒ³ãƒˆ' :
                                selectedAnalysis === 'career' ? 'ã‚­ãƒ£ãƒªã‚¢ç™ºå±•ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹' :
                                'æ‹æ„›é–¢ä¿‚ã‚’å‘ä¸Šã•ã›ã‚‹ãƒ’ãƒ³ãƒˆ';
            
            const adviceText = selectedAnalysis === 'career' ?
                'ã‚ãªãŸã®æ€§æ ¼ç‰¹æ€§ã‚’æ´»ã‹ã›ã‚‹è·å ´ç’°å¢ƒã‚„è·ç¨®ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚å¼·ã¿ã‚’æ´»ã‹ã›ã‚‹åˆ†é‡ã§çµŒé¨“ã‚’ç©ã¿ã€è‹¦æ‰‹ãªåˆ†é‡ã«ã¤ã„ã¦ã¯æ®µéšçš„ã«ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¦ã„ãã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚' :
                selectedAnalysis === 'love' ?
                'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®é–¢ä¿‚ã«ãŠã„ã¦ã€ãŠäº’ã„ã®æ€§æ ¼ç‰¹æ€§ã‚’ç†è§£ã—å°Šé‡ã™ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚è‡ªåˆ†ã®ç‰¹æ€§ã‚’æ´»ã‹ã—ãªãŒã‚‰ã€ç›¸æ‰‹ã¨ã®é•ã„ã‚’å—ã‘å…¥ã‚Œã€ãŠäº’ã„ã‚’è£œå®Œã—åˆãˆã‚‹é–¢ä¿‚ã‚’ç¯‰ã„ã¦ã„ãã¾ã—ã‚‡ã†ã€‚' :
                'ã‚ãªãŸã®æ€§æ ¼ç‰¹æ€§ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€è‡ªåˆ†ã‚‰ã—ã„ç”Ÿãæ–¹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å¼·ã¿ã‚’æ´»ã‹ã—ã€èª²é¡ŒãŒã‚ã‚‹ã¨ã“ã‚ã¯æ„è­˜çš„ã«æˆé•·ã—ã¦ã„ãã“ã¨ã§ã€ã‚ˆã‚Šå……å®Ÿã—ãŸäººç”Ÿã‚’é€ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚';

            adviceDiv.innerHTML = `
                <div class="advice-section">
                    <h3 class="advice-title">${adviceTitle}</h3>
                    <p style="margin:0; line-height:1.6">${adviceText}</p>
                </div>
            `;
        }

        // ç‰¹æ€§è§£èª¬å–å¾—
        function getTraitExplanation(trait, score) {
            const level = getLevel(score);
            const explanations = {
                O: {
                    é«˜: 'æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„ä½“é¨“ã«é–‹ã‹ã‚Œã¦ãŠã‚Šã€å‰µé€ çš„ã§æƒ³åƒåŠ›è±Šã‹ã§ã™ã€‚å¤‰åŒ–ã‚’å¥½ã¿ã€å¾“æ¥ã®æ–¹æ³•ã«ã¨ã‚‰ã‚ã‚Œã¾ã›ã‚“ã€‚',
                    ä¸­: 'æ–°ã—ã„ã“ã¨ã«ã‚ã‚‹ç¨‹åº¦ã®é–¢å¿ƒã‚’æŒã¡ã¤ã¤ã€æ…£ã‚Œè¦ªã—ã‚“ã ã‚‚ã®ã‚‚é‡è¦–ã—ã¾ã™ã€‚ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸæŸ”è»Ÿæ€§ã‚’æŒã£ã¦ã„ã¾ã™ã€‚',
                    ä½: 'æ…£ã‚Œè¦ªã—ã‚“ã æ–¹æ³•ã‚„å®‰å®šã—ãŸç’°å¢ƒã‚’å¥½ã¿ã¾ã™ã€‚å®Ÿç”¨çš„ã§ç¾å®Ÿçš„ãªè€ƒãˆæ–¹ã‚’ã—ã¾ã™ã€‚'
                },
                C: {
                    é«˜: 'è²¬ä»»æ„ŸãŒå¼·ãã€è¨ˆç”»æ€§ãŒã‚ã‚Šã€ç›®æ¨™é”æˆã«å‘ã‘ã¦ç€å®Ÿã«åŠªåŠ›ã—ã¾ã™ã€‚æ™‚é–“ã‚’å®ˆã‚Šã€ç´„æŸã‚’é‡è¦–ã—ã¾ã™ã€‚',
                    ä¸­: 'é©åº¦ãªè¨ˆç”»æ€§ã¨æŸ”è»Ÿæ€§ã‚’å…¼ã­å‚™ãˆã¦ã„ã¾ã™ã€‚é‡è¦ãªã“ã¨ã«ã¯è²¬ä»»ã‚’æŒã£ã¦å–ã‚Šçµ„ã¿ã¾ã™ã€‚',
                    ä½: 'è‡ªç”±åº¦ã‚’é‡è¦–ã—ã€æŸ”è»Ÿãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å¥½ã¿ã¾ã™ã€‚ãã®å ´ã®çŠ¶æ³ã«å¿œã˜ãŸå¯¾å¿œã‚’å¾—æ„ã¨ã—ã¾ã™ã€‚'
                },
                E: {
                    é«˜: 'äººã¨ã®äº¤æµã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¾—ã¦ã€ç¤¾äº¤çš„ã§ç©æ¥µçš„ã§ã™ã€‚ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸­å¿ƒã«ãªã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚',
                    ä¸­: 'çŠ¶æ³ã«å¿œã˜ã¦ç¤¾äº¤çš„ã«ãªã£ãŸã‚Šã€ä¸€äººã®æ™‚é–“ã‚’æ¥½ã—ã‚“ã ã‚Šã§ãã¾ã™ã€‚',
                    ä½: 'å°‘æ•°ã®æ·±ã„é–¢ä¿‚ã‚’é‡è¦–ã—ã€ä¸€äººã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚å†…é¢çš„ãªä¸–ç•Œã‚’è±Šã‹ã«æŒã£ã¦ã„ã¾ã™ã€‚'
                },
                A: {
                    é«˜: 'ä»–äººã¸ã®æ€ã„ã‚„ã‚ŠãŒæ·±ãã€å”åŠ›çš„ã§è¦ªåˆ‡ã§ã™ã€‚èª¿å’Œã‚’é‡è¦–ã—ã€ç›¸æ‰‹ã®æ°—æŒã¡ã‚’ç†è§£ã—ã‚ˆã†ã¨åŠªã‚ã¾ã™ã€‚',
                    ä¸­: 'ä»–äººã‚’æ€ã„ã‚„ã‚Šã¤ã¤ã€è‡ªåˆ†ã®æ„è¦‹ã‚‚é©åˆ‡ã«ä¸»å¼µã§ãã¾ã™ã€‚',
                    ä½: 'è‡ªåˆ†ã®æ„è¦‹ã‚’ã¯ã£ãã‚Šã¨è¡¨ç¾ã—ã€ç›®æ¨™é”æˆã®ãŸã‚ã«ç«¶äº‰çš„ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚'
                },
                N: {
                    é«˜: 'æ„Ÿæƒ…ãŒè±Šã‹ã§æ•æ„Ÿã§ã™ã€‚ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã‚„ã™ãã€å®‰å¿ƒã§ãã‚‹ç’°å¢ƒã‚’é‡è¦–ã—ã¾ã™ã€‚',
                    ä¸­: 'é©åº¦ãªæ•æ„Ÿæ€§ã‚’æŒã¡ãªãŒã‚‰ã€å¤šãã®çŠ¶æ³ã§å®‰å®šã—ã¦ã„ã‚‰ã‚Œã¾ã™ã€‚',
                    ä½: 'æ„Ÿæƒ…çš„ã«å®‰å®šã—ã¦ãŠã‚Šã€ã‚¹ãƒˆãƒ¬ã‚¹ã‚„ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã«å¼·ã„ã§ã™ã€‚å›°é›£ãªçŠ¶æ³ã§ã‚‚å†·é™ã‚’ä¿ã¦ã¾ã™ã€‚'
                }
            };
            
            return explanations[trait][level];
        }

        // æ€§æ ¼ã‚¿ã‚¤ãƒ—åˆ¤å®š
        function getPersonalityType(traits) {
            const levels = ['O', 'C', 'E', 'A', 'N'].map(t => getLevel(traits[t]));
            const [O, C, E, A, N] = levels;

            if (E === 'é«˜' && A === 'é«˜' && N === 'ä½') {
                return {
                    type: 'ç¤¾äº¤çš„ãƒªãƒ¼ãƒ€ãƒ¼ã‚¿ã‚¤ãƒ—',
                    description: 'äººã¨ã®é–¢ã‚ã‚Šã‚’é‡è¦–ã—ã€ãƒãƒ¼ãƒ ã‚’ã¾ã¨ã‚ã‚‹åŠ›ãŒã‚ã‚Šã¾ã™ã€‚ãƒã‚¸ãƒ†ã‚£ãƒ–ã§å”èª¿æ€§ãŒã‚ã‚Šã€å¤šãã®äººã‹ã‚‰ä¿¡é ¼ã•ã‚Œã‚‹æ€§æ ¼ã§ã™ã€‚'
                };
            } else if (O === 'é«˜' && C === 'é«˜') {
                return {
                    type: 'å‰µé€ çš„å®Ÿè¡Œè€…ã‚¿ã‚¤ãƒ—',
                    description: 'æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç”Ÿã¿å‡ºã—ã€ãã‚Œã‚’ç¢ºå®Ÿã«å®Ÿè¡Œã™ã‚‹åŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚è¨ˆç”»æ€§ã¨å‰µé€ æ€§ã‚’å…¼ã­å‚™ãˆã¦ã„ã¾ã™ã€‚'
                };
            } else if (A === 'é«˜' && N === 'ä½' && C === 'é«˜') {
                return {
                    type: 'å®‰å®šã—ãŸæ”¯æ´è€…ã‚¿ã‚¤ãƒ—',
                    description: 'ä»–è€…ã‚’æ”¯ãˆã‚‹ã“ã¨ã«é•·ã‘ã¦ãŠã‚Šã€è²¬ä»»æ„ŸãŒå¼·ãä¿¡é ¼ã§ãã‚‹æ€§æ ¼ã§ã™ã€‚ãƒãƒ¼ãƒ ã®å®‰å®šã‚’ä¿ã¤å½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚'
                };
            } else {
                return {
                    type: 'ãƒãƒ©ãƒ³ã‚¹å‹',
                    description: 'å„ç‰¹æ€§ãŒãƒãƒ©ãƒ³ã‚¹ã‚ˆãç™ºé”ã—ã¦ãŠã‚Šã€æ§˜ã€…ãªçŠ¶æ³ã«é©å¿œã§ãã‚‹æŸ”è»Ÿæ€§ã‚’æŒã£ã¦ã„ã¾ã™ã€‚'
                };
            }
        }

        // ã‚¯ã‚¤ã‚ºãƒªã‚»ãƒƒãƒˆ
        function resetQuiz() {
            currentPhase = 'basic';
            currentQuestions = QUESTIONS.basic;
            currentAnswers = {};
            currentIndex = 0;
            basicResult = null;
            selectedAnalysis = null;

            // UI ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('basicResult').classList.add('hidden');
            document.getElementById('detailedResult').classList.add('hidden');
            document.getElementById('progressSection').classList.remove('hidden');
            document.getElementById('questionSection').classList.remove('hidden');
            document.getElementById('controlSection').classList.remove('hidden');
            document.getElementById('phaseTitle').textContent = 'åŸºæœ¬è¨ºæ–­ï¼ˆ5å•ï¼‰';
            document.getElementById('resultBtn').textContent = 'åŸºæœ¬çµæœã‚’è¦‹ã‚‹';

            updateUI();
        }

        // UIæ›´æ–°
        function updateUI() {
            const currentQuestion = currentQuestions[currentIndex];
            const answered = currentAnswers[currentQuestion?.id];
            const answeredCount = Object.keys(currentAnswers).length;
            const progress = currentQuestions.length ? Math.round((answeredCount / currentQuestions.length) * 100) : 0;
            const allAnswered = currentQuestions.every(q => currentAnswers[q.id] !== undefined);

            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°
            document.getElementById('progressInfo').textContent = `${currentIndex + 1}/${currentQuestions.length}`;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('metaInfo').textContent = `é€²æ— ${progress}%`;

            // è³ªå•è¡¨ç¤º
            if (currentQuestion) {
                document.getElementById('questionText').textContent = currentQuestion.text;

                // å›ç­”é¸æŠè‚¢
                const optionsDiv = document.getElementById('answerOptions');
                optionsDiv.innerHTML = [1, 2, 3, 4, 5].map(value => `
                    <div class="option ${answered === value ? 'active' : ''}" 
                         data-value="${value}" 
                         onclick="answerQuestion(${value})">
                        ${SCALE_LABELS[value]}
                    </div>
                `).join('');

                // æ³¨æ„ãƒã‚§ãƒƒã‚¯è¡¨ç¤º
                const attentionNote = document.getElementById('attentionNote');
                if (currentQuestion.type === 'attention') {
                    attentionNote.style.display = 'block';
                } else {
                    attentionNote.style.display = 'none';
                }
            }

            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex >= currentQuestions.length - 1;
            document.getElementById('resultBtn').disabled = !allAnswered;
        }

        // åˆæœŸåŒ–å®Ÿè¡Œ
        window.onload = init;
    </script>
</body>
</html>